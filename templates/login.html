<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% block title %}
       <title>博客｜用户登陆</title>
    {% endblock %}

    <link rel="stylesheet" href="/static/my/css/reset.css">
    <link rel="stylesheet" href="/static/my/css/login.css">

</head>
<body>
    <div id="app">
        <main>
            <div class="top">
                <div class="title">
                    {% block main_title%}
                        <a href="/login" class="active">登陆</a> /
                        <a href="/sign">注册</a>
                    {% endblock %}
                    
                </div>
                <div class="login_forms">
                    {% csrf_token %}
                    {% block form%}
                        <input type="text" v-model="login_form.name" placeholder="请输入用户名">
                        <input type="text" v-model="login_form.pwd" placeholder="请输入密码">
                        <div class="code">
                            <input v-model="login_form.code"  type="text" placeholder="请输入验证码">
                            <img src="/login/random_code/" alt="">
                        </div>
                        <button @click="login" >登陆</button>
                    {% endblock %}
                </div>
                <div class="other_login">
                    <p>其他方式登陆</p>
                    <div>
                        <img src="/static/my/img/footer/qq_icon.svg" alt="">
                        <img src="/static/my/img/footer/wexin_icon.svg" alt="">
                        <img src="/static/my/img/footer/weibo_icon.svg" alt="">
                    </div>
                </div>
            </div>

            <div class="bootm">
                <img src="/static/my/login/new_year_2022.svg" alt="">
            </div>
        </main>
    </div>

    <script src="/static/axios/axios.min.js"></script>
    <script src="/static/vue/vue.js"></script>
    <script>
        axios.interceptors.request.use(
            request=>{
                if (request.method === 'post'){
                    let csrftoken = document.querySelector('input[name="csrfmiddlewaretoken"]').value
                    request.headers[ 'X-CSRFToken'] = csrftoken
                }
                return request
            })
        axios.interceptors.response.use(
            response=>{
                console.log(response)
                return response
            })

        new Vue({
            el:'#app',
            data:{
                login_form:{
                    name:'',
                    pwd:'',
                    code:'',
                }
            },
            methods:{
                login(){
                    axios.post('/login/', this.login_form).then(res=>{
                        console.log(res)
                    })
                }
            }
        })
    </script>

</body>
</html>